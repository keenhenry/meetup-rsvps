{"paragraphs":[{"text":"%pyspark\nfrom pyspark.sql.functions import explode\nfrom time import time","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744314_1144859923","id":"20170501-035626_627189763","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2375"},{"text":"%pyspark\ns = time()\nraw_rsvps = spark.read.json(\"s3a://tristan-meetup-data/2017/*/*/*/*\").cache()\nprint (time() - s)","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"161.500201941\n"}]},"apps":[],"jobName":"paragraph_1493711744318_1143320927","id":"20170501-035639_1180379613","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2376"},{"text":"%pyspark\nschema = raw_rsvps.schema\n# raw_rsvps.printSchema()","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744319_1142936178","id":"20170501-035721_768140648","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2377"},{"text":"%pyspark\nrsvps_col = [\n    'rsvp_id',\n    'event.event_id',\n    'group.group_id',\n    'member.member_id',\n    'venue.venue_id',\n    'guests',\n    'mtime',\n    'response',\n    'visibility'\n]\ngroups_col = [\n    'group_id',\n    'group_city',\n    'group_country',\n    'group_lat',\n    'group_lon',\n    'group_name',\n    'group_state',\n    'group_urlname'\n]\nevents_col = [\n    'event_id',\n    'event_name',\n    'event_url',\n    'time'\n]\nmembers_col = [\n    'member_id',\n    'member_name',\n    'photo'\n]\nvenues_col = [\n    'venue_id',\n    'venue_name',\n    'lat',\n    'lon'\n]\ntopics_col = [\n    'urlkey',\n    'topic_name'\n]","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744321_1128315720","id":"20170501-035742_212071628","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2378"},{"text":"%pyspark\nrsvps = raw_rsvps.select(rsvps_col).distinct()\nrsvps.write.parquet(\"s3a://tristan-meetup-data/rsvps\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744323_1129085218","id":"20170501-035758_1680736079","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2379"},{"text":"%pyspark\nmembers = raw_rsvps.select(\"member.*\").distinct()\nmembers.write.parquet(\"s3a://tristan-meetup-data/members\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744326_1127930971","id":"20170501-035819_1456569550","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2380"},{"text":"%pyspark\nevents = raw_rsvps.select([\"event.\"+col for col in events_col]).distinct()\nevents.write.parquet(\"s3a://tristan-meetup-data/events\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744327_1127546222","id":"20170501-035828_1460037093","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2381"},{"text":"%pyspark\ntopics = raw_rsvps.select(explode(raw_rsvps.group.group_topics).alias(\"tmp\")).select(\"tmp.*\")\ntopics.write.parquet(\"s3a://tristan-meetup-data/topics\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744329_1125237729","id":"20170501-040107_55939019","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2382"},{"text":"%pyspark\nvenues = raw_rsvps.select([\"venue.\"+col for col in venues_col]).distinct()\nvenues.write.parquet(\"s3a://tristan-meetup-data/venues\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744330_1126391976","id":"20170501-042142_1876052746","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2383"},{"text":"%pyspark\ngroups = raw_rsvps.select([\"group.\"+col for col in groups_col]).distinct()\ngroups.write.parquet(\"s3a://tristan-meetup-data/groups\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744332_1124083482","id":"20170501-040113_2072768403","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2384"},{"text":"%pyspark\ngroups_topics = raw_rsvps.select(\"group.group_id\", explode(raw_rsvps.group.group_topics.urlkey).alias(\"urlkey\")).distinct()\ngroups_topics.cache() # use for analysis below\ngroups_topics.write.parquet(\"s3a://tristan-meetup-data/groups_topics\")","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744336_1134856452","id":"20170501-040206_246801678","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2385"},{"text":"%pyspark\ncounts = groups_topics.groupby(\"urlkey\").count().orderBy(\"count\", ascending=False)","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1493711744339_1135241200","id":"20170501-040212_911753660","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2386"},{"text":"%pyspark\nprint(counts.limit(20).show(20))","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|              urlkey|count|\n+--------------------+-----+\n|    self-improvement|14187|\n|       socialnetwork|10619|\n|              social|10163|\n|        spirituality| 9856|\n|    entrepreneurship| 9572|\n|          meditation| 9226|\n|professional-netw...| 9088|\n|            wellness| 8798|\n|           fun-times| 8471|\n|           newintown| 8178|\n|    self-empowerment| 7371|\n|            outdoors| 7217|\n|      healthy-living| 7163|\n|             fitness| 6723|\n|       consciousness| 6410|\n|    self-exploration| 6231|\n|   business-strategy| 6089|\n|           excercise| 5858|\n|         softwaredev| 5826|\n|  startup-businesses| 5621|\n+--------------------+-----+\n\nNone\n"}]},"apps":[],"jobName":"paragraph_1493711744341_1132932707","id":"20170501-040233_677377129","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2387"},{"text":"%pyspark\n","dateUpdated":"2017-05-02T00:55:44-0700","config":{"colWidth":12,"editorMode":"ace/mode/python","results":{},"enabled":true,"editorSetting":{"language":"python","editOnDblClick":false}},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1493711744342_1134086954","id":"20170501-040857_1887966510","dateCreated":"2017-05-02T00:55:44-0700","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:2388"}],"name":"lab6.1-tristan","id":"2CGGKJZER","angularObjects":{"2CFMV8F64:shared_process":[],"2CFVNJTTG:shared_process":[],"2CEN8R7S1:shared_process":[],"2CE7RAVFU:shared_process":[],"2CFDUD7MJ:shared_process":[],"2CH9ABK7E:shared_process":[],"2CJ2ERFMG:shared_process":[],"2CERNSCC2:shared_process":[],"2CHHYXH6U:shared_process":[],"2CG7QNDVS:shared_process":[],"2CJ4BWTEA:shared_process":[],"2CJ13ZP3R:shared_process":[],"2CEEVWEEX:shared_process":[],"2CGQCAYBQ:shared_process":[],"2CH8M5ETV:shared_process":[],"2CFV46HVV:shared_process":[],"2CG1HQN3J:shared_process":[],"2CFSMEG9A:shared_process":[],"2CHSDY5H8:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}